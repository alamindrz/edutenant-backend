<!-- templates/users/partials/applications_table.html -->
<div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
            <tr>
                <th>Applicant</th>
                <th>Position</th>
                <th>Experience</th>
                <th>Qualification</th>
                <th>Status</th>
                <th>Applied</th>
                <th width="120">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for application in applications %}
            <tr class="application-row">
                <td>
                    <div class="d-flex align-items-center">
                        <div class="application-avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3"
                             style="width: 40px; height: 40px;">
                            {{ application.first_name|first|upper }}{{ application.last_name|first|upper }}
                        </div>
                        <div>
                            <div class="fw-semibold">{{ application.full_name }}</div>
                            <small class="text-muted">{{ application.email }}</small>
                            <br>
                            <small class="text-muted">{{ application.phone_number|default:"" }}</small>
                        </div>
                    </div>
                </td>
                <td>
                    <span class="fw-medium">{{ application.position_applied }}</span>
                    <br>
                    <small class="text-muted text-capitalize">
                        {{ application.get_application_type_display|default:"" }}
                    </small>
                </td>
                <td>
                    <span class="fw-medium">{{ application.years_of_experience|default:"0" }}</span>
                    <small class="text-muted d-block">years</small>
                </td>
                <td>
                    <span class="fw-medium">{{ application.qualification|default:"Not specified" }}</span>
                    {% if application.specialization %}
                    <br>
                    <small class="text-muted">{{ application.specialization }}</small>
                    {% endif %}
                </td>
                <td>
                    {% if application.status == 'pending' %}
                    <span class="badge bg-warning status-badge">Pending</span>
                    {% elif application.status == 'approved' %}
                    <span class="badge bg-success status-badge">Approved</span>
                    {% elif application.status == 'rejected' %}
                    <span class="badge bg-danger status-badge">Rejected</span>
                    {% else %}
                    <span class="badge bg-secondary status-badge">{{ application.status|title }}</span>
                    {% endif %}
                </td>
                <td>
                    <small class="text-muted">{{ application.created_at|date:"M j, Y" }}</small>
                    <br>
                    <small class="text-muted">{{ application.created_at|timesince }} ago</small>
                </td>
                <td>
                    <div class="d-flex gap-1 action-buttons">
                        <!-- View Details Button -->
                        <button class="btn btn-sm btn-outline-primary" 
                                hx-get="{% url 'users:application_detail' application.id %}"
                                hx-target="#applicationDetailContent"
                                hx-trigger="click"
                                data-bs-toggle="modal" 
                                data-bs-target="#applicationDetailModal"
                                title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        
                        {% if application.status == 'pending' %}
                        <!-- Approve Button -->
                        <button class="btn btn-sm btn-outline-success" 
                                hx-post="{% url 'users:approve_application' application.id %}"
                                hx-target="#applications-table-content"
                                hx-confirm="Are you sure you want to approve this application?"
                                hx-indicator="#applications-loading"
                                title="Approve Application">
                            <i class="fas fa-check"></i>
                        </button>
                        
                        <!-- Reject Button -->
                        <button class="btn btn-sm btn-outline-danger" 
                                hx-post="{% url 'users:reject_application' application.id %}"
                                hx-target="#applications-table-content"
                                hx-confirm="Are you sure you want to reject this application?"
                                hx-indicator="#applications-loading"
                                title="Reject Application">
                            <i class="fas fa-times"></i>
                        </button>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center py-4">
                    <div class="text-muted">
                        <i class="fas fa-inbox fa-2x d-block mb-2"></i>
                        No applications found
                        {% if search or status_filter or position_filter %}
                        <br><small>Try adjusting your filters</small>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    {% if applications.has_other_pages %}
    <div class="card-footer">
        <nav aria-label="Application pagination">
            <ul class="pagination justify-content-center mb-0">
                {% if applications.has_previous %}
                <li class="page-item">
                    <a class="page-link" 
                       hx-get="{% url 'users:applications_table_partial' %}"
                       hx-target="#applications-table-content"
                       hx-vals='{"page": "{{ applications.previous_page_number }}", "search": "{{ search }}", "status": "{{ status_filter }}", "position": "{{ position_filter }}"}'
                       href="?page={{ applications.previous_page_number }}">&laquo;</a>
                </li>
                {% endif %}
                
                {% for i in applications.paginator.page_range %}
                <li class="page-item {% if applications.number == i %}active{% endif %}">
                    <a class="page-link" 
                       hx-get="{% url 'users:applications_table_partial' %}"
                       hx-target="#applications-table-content"
                       hx-vals='{"page": "{{ i }}", "search": "{{ search }}", "status": "{{ status_filter }}", "position": "{{ position_filter }}"}'
                       href="?page={{ i }}">{{ i }}</a>
                </li>
                {% endfor %}
                
                {% if applications.has_next %}
                <li class="page-item">
                    <a class="page-link" 
                       hx-get="{% url 'users:applications_table_partial' %}"
                       hx-target="#applications-table-content"
                       hx-vals='{"page": "{{ applications.next_page_number }}", "search": "{{ search }}", "status": "{{ status_filter }}", "position": "{{ position_filter }}"}'
                       href="?page={{ applications.next_page_number }}">&raquo;</a>
                </li>
                {% endif %}
            </ul>
        </nav>
    </div>
    {% endif %}
</div>