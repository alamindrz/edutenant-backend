<!-- templates/users/partials/staff_table.html -->
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Staff Members</h5>
        <span class="badge bg-primary">{{ staff_members.count }} staff</span>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover table-striped mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Staff ID</th>
                        <th>Name</th>
                        <th>Position</th>
                        <th>Department</th>
                        <th>Email</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for staff in staff_members %}
                    <tr>
                        <td>
                            <strong>{{ staff.staff_id }}</strong>
                        </td>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"
                                     style="width: 32px; height: 32px;">
                                    {{ staff.first_name|first|upper }}{{ staff.last_name|first|upper }}
                                </div>
                                <div>
                                    <strong>{{ staff.full_name }}</strong>
                                    {% if staff.user %}
                                    <small class="text-muted d-block">User account</small>
                                    {% endif %}
                                </div>
                            </div>
                        </td>
                        <td>{{ staff.position }}</td>
                        <td>{{ staff.department|default:"-" }}</td>
                        <td>{{ staff.email }}</td>
                        <td>
                            <span class="badge {% if staff.is_active %}bg-success{% else %}bg-secondary{% endif %}">
                                {% if staff.is_active %}Active{% else %}Inactive{% endif %}
                            </span>
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <a href="{% url 'users:staff_detail' staff.id %}" class="btn btn-outline-primary" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <button class="btn {% if staff.is_active %}btn-warning{% else %}btn-success{% endif %}"
                                        hx-post="{% url 'users:staff_toggle_active' staff.id %}"
                                        hx-target="closest tr"
                                        hx-swap="outerHTML"
                                        hx-confirm="{% if staff.is_active %}Deactivate this staff member?{% else %}Activate this staff member?{% endif %}"
                                        title="{% if staff.is_active %}Deactivate{% else %}Activate{% endif %}">
                                    <i class="fas {% if staff.is_active %}fa-times{% else %}fa-check{% endif %}"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center py-4">
                            <i class="fas fa-users fa-2x text-muted mb-2"></i>
                            <p class="text-muted">No staff members found</p>
                            <a href="{% url 'users:staff_create' %}" class="btn btn-primary btn-sm">
                                Add Your First Staff Member
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% if staff_members.has_other_pages %}
        <div class="card-footer">
            <nav aria-label="Staff pagination">
                <ul class="pagination justify-content-center mb-0">
                    {% if staff_members.has_previous %}
                    <li class="page-item">
                        <a class="page-link" 
                           hx-get="{% url 'users:staff_table_partial' %}"
                           hx-target="#staff-table"
                           hx-vals='{"page": "{{ staff_members.previous_page_number }}", "search": "{{ search_query }}", "active": "{{ active_filter }}"}'
                           href="?page={{ staff_members.previous_page_number }}">&laquo;</a>
                    </li>
                    {% endif %}
                    
                    {% for i in staff_members.paginator.page_range %}
                    <li class="page-item {% if staff_members.number == i %}active{% endif %}">
                        <a class="page-link" 
                           hx-get="{% url 'users:staff_table_partial' %}"
                           hx-target="#staff-table"
                           hx-vals='{"page": "{{ i }}", "search": "{{ search_query }}", "active": "{{ active_filter }}"}'
                           href="?page={{ i }}">{{ i }}</a>
                    </li>
                    {% endfor %}
                    
                    {% if staff_members.has_next %}
                    <li class="page-item">
                        <a class="page-link" 
                           hx-get="{% url 'users:staff_table_partial' %}"
                           hx-target="#staff-table"
                           hx-vals='{"page": "{{ staff_members.next_page_number }}", "search": "{{ search_query }}", "active": "{{ active_filter }}"}'
                           href="?page={{ staff_members.next_page_number }}">&raquo;</a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
        {% endif %}
    </div>
</div>